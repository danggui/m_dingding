define(["View",getViewTemplatePath("MyWork_List"),"MyWorkListModel","UIScroll","LanguageStore"],function(a,b,c,d,e){var f=e.getInstance();return _.inherit(a,{onCreate:function(){this.$el.html(b),$("#todolist-title")[0].innerHTML=f.getAttr("language").todoList},events:{"click .filter-icon":"work_menu","click #work_todo":"work_todo","click #work_hint":"work_hint","click #work_notify":"work_notify","click #work_all":"work_all"},work_menu:function(){this.$(".workMenu").hide(),this.$("#filterMenu").show()},work_todo:function(){var a=_.filter(this.datamodel,function(a){return a.type>="0"&&a.type<="1"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"待办事项",total:a.length})),this.$(".workMenu").hide(),this.$("#todoMenu").show(),this.refreshHeight()},work_hint:function(){var a=_.filter(this.datamodel,function(a){return a.type>="2"&&a.type<="6"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"提醒",total:a.length})),this.$(".workMenu").hide(),this.$("#HintMenu").show(),this.refreshHeight()},work_notify:function(){var a=_.filter(this.datamodel,function(a){return a.type>="7"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"通知",total:a.length})),this.$(".workMenu").hide(),this.$("#NotifyMenu").show(),this.refreshHeight()},wait_apply:function(){var a=_.filter(this.datamodel,function(a){return a.type>="7"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"待审批",total:a.length})),this.$(".workMenu").hide(),this.refreshHeight()},on_apply:function(){var a=_.filter(this.datamodel,function(a){return a.type>="7"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"审批中",total:a.length})),this.$(".workMenu").hide(),this.refreshHeight()},has_apply:function(){var a=_.filter(this.datamodel,function(a){return a.type>="7"});this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:a})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"已审批",total:a.length})),this.$(".workMenu").hide(),this.refreshHeight()},work_all:function(){this.$("#scoller-wrap").html(_.template(this.els.myworkList_tpl.html())({mywork_list_data:this.datamodel})),this.$(".head-wrap").html(_.template(this.els.total_tpl.html())({total_title:"",total:this.datamodel.length})),this.$(".workMenu").hide(),this.$("#filterMenu").show(),this.refreshHeight()},onPreShow:function(){this.turning()},onShow:function(){this.queryData();var a=this,b=a.$("#pullDown")[0],c=b.offsetHeight;this.scroll||(this.scroll=new d({wrapper:this.$("#myworkList_wrap"),scroller:this.$("#scroller"),topOffset:c,onRefresh:function(){b.className.match("loading")&&(b.className="",b.querySelector(".pullDownLabel").innerHTML="下拉刷新...")},onScrollMove:function(){this.y>5&&!b.className.match("flip")?(b.className="flip",b.querySelector(".pullDownLabel").innerHTML="松手开始更新...",this.minScrollY=0):this.y<5&&b.className.match("flip")&&(b.className="",b.querySelector(".pullDownLabel").innerHTML="下拉刷新...",this.minScrollY=-c)},onScrollEnd:function(){b.className.match("flip")&&(b.className="loading",b.querySelector(".pullDownLabel").innerHTML="加载中...",a.queryData())}})),this.refreshHeight()},queryData:function(){var a=c.getInstance();a.execute(function(a){if(this.datamodel=a.data,location.href.lastIndexOf("!")+1>0){var b=location.href.substring(location.href.lastIndexOf("!")+1,location.href.length);switch(b){case"work_todo":this.work_todo();break;case"work_hint":this.work_hint();break;case"on_apply":this.on_apply();break;case"wait_apply":this.wait_apply();break;case"has_apply":this.has_apply();break;case"work_notify":this.work_notify();break;default:this.work_all()}}else this.work_all()},function(a){},this)},refreshHeight:function(){this.scroll&&this.scroll.refresh&&this.scroll.refresh()},onHide:function(){}})});