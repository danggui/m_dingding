define(["View",getViewTemplatePath("MyWork_leaveRequest"),"UIToast","LeaveListModel","UIScroll","LanguageStore","DoLeaveApplyModel","UIRadioList","LeaveDaysModel"],function(a,b,c,d,e,f,g,h,i){var j=f.getInstance(),k=(d.getInstance(),g.getInstance()),l=i.getInstance(),m=[{leave_type:"1",leave_name:"年假"},{leave_type:"2",leave_name:"事假"},{leave_type:"3",leave_name:"病假"},{leave_type:"6",leave_name:"婚假"},{leave_type:"7",leave_name:"丧假"},{leave_type:"8",leave_name:"产假"},{leave_type:"10",leave_name:"陪产假"},{leave_type:"11",leave_name:"计划生育假"}],n=[{leave_type:"1",leave_name:"Annual Leave"},{leave_type:"2",leave_name:"Private Affair Leave"},{leave_type:"3",leave_name:"Sick Leave"},{leave_type:"6",leave_name:"Marriage Leave"},{leave_type:"7",leave_name:"Funeral Leave"},{leave_type:"8",leave_name:"Abortion Leave"},{leave_type:"10",leave_name:"Paternity Leave"},{leave_type:"11",leave_name:"Family Planning Leave"}];return _.inherit(a,{onCreate:function(){this.$el.html(b),$("#leave_type")[0].innerHTML=j.getAttr("language").leaveType,$("#leaveRequest-title")[0].innerHTML=j.getAttr("language").leaveApplyButton,$(".leaveReason")[0].innerHTML=j.getAttr("language").leaveReason,$(".leave-reason-prompt")[0].placeholder=j.getAttr("language").leaveReasonPrompt,$(".leaveTime")[0].innerHTML=j.getAttr("language").leaveTime,$(".leaveTimeStart")[0].innerHTML=j.getAttr("language").leaveTimeStart,$(".leaveTimeEnd")[0].innerHTML=j.getAttr("language").leaveTimeEnd,$(".leaveTimeDays")[0].innerHTML=j.getAttr("language").leaveTimeDays,$(".leaveApplySubmit")[0].innerHTML=j.getAttr("language").submit},events:{"click #selectLeaveType":"selectLeaveType","click #startTime":"start_Time","click #endTime":"end_Time","click #leaveApplySubmit":"leaveApplySubmit"},leaveApplySubmit:function(){if(this.toast1||(this.toast1=new c({datamodel:{content:"content"},TIMERRES:!0})),"0"==$("#leave_type").attr("placeholder"))this.toast1.showToast(j.getAttr("language").selectLeaveType);else if("0000-00-00"==$("#input_startDate")[0].innerHTML)this.toast1.showToast(j.getAttr("language").selectLeaveStart);else if("0000-00-00"==$("#input_endDate")[0].innerHTML)this.toast1.showToast(j.getAttr("language").selectLeaveEnd);else if(""==$("#leave_reason")[0].value)this.toast1.showToast(j.getAttr("language").selectLeaveReason);else{var a=new Date,b=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),d=$("#input_startDate")[0].innerHTML.split(" ")[0],e=$("#input_startDate")[0].innerHTML.split(" ")[1],f=$("#input_endDate")[0].innerHTML.split(" ")[0],g=$("#input_endDate")[0].innerHTML.split(" ")[1],h=$("#input_leaveDays").attr("placeholder"),i=$("#leave_reason")[0].value;k.execute(function(a,b,c,d){return"0"==b.status?(this.toast1.showToast(b.message),!1):(this.toast1.showToast(b.message),void this.back())},function(a){0},this,function(a){},{type:$("#leave_type").attr("placeholder"),a_date:b,s_date:d,s_time:e,e_date:f,e_time:g,days:h,reason:i})}},selectLeaveType:function(){var a=[],b=this;this.selectType_radio||("zh_cn"==j.getAttr("language").languageFlag?_.each(m,function(b,c,d){a.push({id:b.leave_type,name:b.leave_name})}):_.each(n,function(b,c,d){a.push({id:b.leave_type,name:b.leave_name})}),this.selectType_radio=new h({datamodel:{title:j.getAttr("language").selectLeaveType,data:a},displayNum:5,selectId:4,index:4,onClick:function(a,c){b.$("#leave_type").text(c.name),$("#leave_type").attr("placeholder",c.id),this.hide(),b.leaveTimeDays()}})),this.selectType_radio.show()},start_Time:function(){this.forward("MyWork_calander&S")},end_Time:function(){this.forward("MyWork_calander&E")},leaveTimeDays:function(){localStorage.leaveStartTime&&localStorage.leaveStartHalfDay&&localStorage.leaveEndTime&&localStorage.leaveEndHalfDay&&"0"!=$("#leave_type").attr("placeholder")&&l.execute(function(a,b,d,e){return"0"==b.status?(this.toast1||(this.toast1=new c({datamodel:{content:"content"},TIMERRES:!0})),this.toast1.showToast(b.message),!1):void $("#input_leaveDays").attr("placeholder",b.message)},function(a){0},this,function(a){},{s_date:localStorage.leaveStartTime,s_time:localStorage.leaveStartHalfDay,e_date:localStorage.leaveEndTime,e_time:localStorage.leaveEndHalfDay,type:$("#leave_type").attr("placeholder")})},onPreShow:function(){this.turning()},onShow:function(){localStorage.leaveStartTime&&($("#input_startDate")[0].innerHTML=localStorage.leaveStartTime+" "+localStorage.leaveStartHalfDay),localStorage.leaveEndTime&&($("#input_endDate")[0].innerHTML=localStorage.leaveEndTime+" "+localStorage.leaveEndHalfDay),this.leaveTimeDays()},onHide:function(){}})});